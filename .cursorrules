Project Framework
- 使用 Next.js 作为本项目的前后端一体框架（SSR/SSG/Edge 友好）。

Authoritative References
- Next.js 官方文档（遇到实现/决策时的首要参考）：https://nextjs.org/docs
- 数据库配置与使用指南：./DATABASE_SETUP.md
- API 接口文档：./API_DOCUMENTATION.md

Template for Build and Problem-Solving
- 参考模板工程目录（构建与问题解决的重要依据）：
  ./next.js/examples/

Guidance and Priorities
- 参考优先级：本仓库现有实现 > 数据库配置指南 > API 接口文档 > 上述模板工程 > 官方文档。
- 遵循官方最佳实践与默认约定，避免不必要的自定义与复杂化。
- 默认部署目标为单机/轻量环境；如需扩展再进行优化与拆分。
- 数据库相关操作请参考 DATABASE_SETUP.md 中的详细说明。
- API 接口开发请参考 API_DOCUMENTATION.md 中的接口规范和测试用例。

Operational Notes
- 解决问题或选型时，首先查阅"Next.js 官方文档"与"模板工程实现"，保持一致性。
- 数据库相关问题请优先参考 DATABASE_SETUP.md 中的配置说明和 API 接口文档。
- API 接口开发请严格按照 API_DOCUMENTATION.md 中的规范实现，确保接口一致性。
- 使用 test/api-test.http 文件进行 API 接口测试，确保功能正确性。
- 如需偏离上述参考，需给出明确理由（可维护性/安全/性能/成本等）。

Environment Configuration
- 所有使用数据库的 API 接口文件必须在文件顶部添加环境变量设置：
  ```javascript
  // 确保环境变量被设置
  if (!process.env.DATABASE_URL) {
    process.env.DATABASE_URL = "file:./dev.db"
    console.log('设置 DATABASE_URL 环境变量:', process.env.DATABASE_URL)
  }
  ```
- 数据库连接使用相对路径 "file:./dev.db"，确保跨平台兼容性。
- 生产环境需要配置正确的 DATABASE_URL 环境变量。
- 已配置的 API 文件：
  - shop/pages/api/appointments/index.js
  - admin/pages/api/appointments/index.js
  - admin/pages/api/appointments/[id].js
  - admin/pages/api/appointments/stats.js

Known Issues & TODO
- [ ] 修复环境变量配置不一致问题：当前 lib/prisma.ts 使用绝对路径，API 接口使用相对路径
- [ ] 统一环境变量管理：建议使用 .env.local 文件统一管理环境变量
- [ ] 移除硬编码的环境变量设置，改为从环境变量文件读取

Build & Repo Boundaries
- 本项目在仓库根目录构建与运行。
- `next.js` 目录为下载的参考工程，禁止修改（只读）。如需实现功能，请在仓库根目录新增/修改代码。
- 业务页面与 API 放置于仓库根的 `pages/` 与 `pages/api/`。

