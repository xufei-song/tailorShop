# Prismaå®¢æˆ·ç«¯ç®¡ç†è„šæœ¬

## ğŸš€ å¿«é€Ÿä½¿ç”¨

### é‡ç½®Prismaå®¢æˆ·ç«¯ï¼ˆæ¨èï¼‰
```bash
# æ–¹æ³•1: æ ‡å‡†é‡ç½®ï¼ˆæ¨èï¼Œè·¨å¹³å°ï¼‰
npm run reset-prisma

# æ–¹æ³•2: å¼ºåˆ¶é‡ç½®ï¼ˆåŒ…å«è¿›ç¨‹ç»ˆæ­¢ï¼‰
npm run reset-prisma:kill

# æ–¹æ³•3: ç›´æ¥è¿è¡Œè„šæœ¬
node scripts/reset-prisma.js

# æ–¹æ³•4: å¸¦å‚æ•°è¿è¡Œ
node scripts/reset-prisma.js --kill
```

### åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·
```bash
npm run create-admin
```

## ğŸ“‹ è„šæœ¬åŠŸèƒ½

### `reset-prisma.js` - Prismaå®¢æˆ·ç«¯é‡ç½®è„šæœ¬
**åŠŸèƒ½ï¼š**
- âœ… åˆ é™¤æŸåçš„Prismaå®¢æˆ·ç«¯ç›®å½•
- âœ… é‡æ–°ç”ŸæˆPrismaå®¢æˆ·ç«¯
- âœ… åŒæ­¥æ•°æ®åº“ç»“æ„
- âœ… éªŒè¯æ‰€æœ‰è¡¨æ˜¯å¦æ­£å¸¸å·¥ä½œ
- âœ… è·¨å¹³å°å…¼å®¹ï¼ˆWindows/Linux/macOSï¼‰
- âœ… å½©è‰²è¾“å‡ºï¼Œæ­¥éª¤æ¸…æ™°
- âœ… å¯é€‰çš„è¿›ç¨‹ç»ˆæ­¢åŠŸèƒ½
- âœ… è¯¦ç»†çš„é”™è¯¯å¤„ç†å’Œè§£å†³å»ºè®®

**ä½¿ç”¨æ–¹å¼ï¼š**
- `npm run reset-prisma` - æ ‡å‡†é‡ç½®
- `npm run reset-prisma:kill` - å¼ºåˆ¶é‡ç½®ï¼ˆåŒ…å«è¿›ç¨‹ç»ˆæ­¢ï¼‰
- `node scripts/reset-prisma.js --kill` - å¸¦å‚æ•°è¿è¡Œ

**é€‚ç”¨åœºæ™¯ï¼š**
- Prismaå®¢æˆ·ç«¯ç”Ÿæˆå¤±è´¥
- æ•°æ®åº“è¡¨ç»“æ„ä¸åŒæ­¥
- Schemaæ›´æ–°åéœ€è¦é‡æ–°ç”Ÿæˆ
- æ—¥å¸¸ç»´æŠ¤å’Œè°ƒè¯•
- æ–‡ä»¶å ç”¨é—®é¢˜

## ğŸ”§ å…¶ä»–å¯ç”¨å‘½ä»¤

```bash
# æ•°æ®åº“æ“ä½œ
npm run db:generate    # ç”ŸæˆPrismaå®¢æˆ·ç«¯
npm run db:push        # æ¨é€æ•°æ®åº“ç»“æ„
npm run db:seed        # è¿è¡Œæ•°æ®åº“ç§å­

# åº”ç”¨å¯åŠ¨
npm run dev:admin      # å¯åŠ¨ç®¡ç†åå° (ç«¯å£3001)
npm run dev:web        # å¯åŠ¨å‰ç«¯åº—é“º (ç«¯å£3000)
```

## ğŸ†˜ å¸¸è§é—®é¢˜è§£å†³

### 1. EPERMæƒé™é”™è¯¯
```
Error: EPERM: operation not permitted
```
**è§£å†³æ–¹æ¡ˆï¼š** 
- Windows: ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡ŒPowerShell
- Linux/macOS: ä½¿ç”¨ `sudo` è¿è¡Œæˆ–æ£€æŸ¥æ–‡ä»¶æƒé™

### 2. è¡¨ä¸å­˜åœ¨é”™è¯¯
```
Error: Table 'admin_users' does not exist
```
**è§£å†³æ–¹æ¡ˆï¼š** è¿è¡Œ `npm run reset-prisma`

### 3. Prismaå®¢æˆ·ç«¯æœªæ‰¾åˆ°
```
Error: Cannot find module '@prisma/client'
```
**è§£å†³æ–¹æ¡ˆï¼š** 
1. è¿è¡Œ `npm install`
2. è¿è¡Œ `npm run reset-prisma`

### 4. æ•°æ®åº“è¿æ¥å¤±è´¥
```
Error: Can't reach database server
```
**è§£å†³æ–¹æ¡ˆï¼š** æ£€æŸ¥ `.env` æ–‡ä»¶ä¸­çš„ `DATABASE_URL` é…ç½®

### 5. æ–‡ä»¶å ç”¨é—®é¢˜
```
Error: EBUSY: resource busy or locked
```
**è§£å†³æ–¹æ¡ˆï¼š** è¿è¡Œ `npm run reset-prisma:full`ï¼ˆä¼šåœæ­¢Node.jsè¿›ç¨‹ï¼‰

## ğŸ¯ æ¨èå·¥ä½œæµç¨‹

### é¦–æ¬¡è®¾ç½®
```bash
# 1. å®‰è£…ä¾èµ–
npm install

# 2. é‡ç½®Prismaå®¢æˆ·ç«¯
npm run reset-prisma

# 3. åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·
npm run create-admin

# 4. å¯åŠ¨ç®¡ç†åå°
npm run dev:admin
```

### æ—¥å¸¸å¼€å‘
```bash
# é‡åˆ°Prismaé—®é¢˜æ—¶
npm run reset-prisma
```

### ä¸¥é‡é—®é¢˜æ—¶
```bash
# å¼ºåˆ¶é‡ç½®ï¼ˆä¼šåœæ­¢æ‰€æœ‰Node.jsè¿›ç¨‹ï¼‰
npm run reset-prisma:kill
```

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **é¦–æ¬¡ä½¿ç”¨**ï¼šç¡®ä¿å·²è¿è¡Œ `npm install` å®‰è£…ä¾èµ–
2. **ç¯å¢ƒå˜é‡**ï¼šç¡®ä¿ `.env` æ–‡ä»¶å­˜åœ¨ä¸”é…ç½®æ­£ç¡®
3. **æ•°æ®å®‰å…¨**ï¼šé‡ç½®è„šæœ¬ä¸ä¼šåˆ é™¤æ•°æ®åº“æ•°æ®
4. **è·¨å¹³å°**ï¼šJavaScriptè„šæœ¬åœ¨æ‰€æœ‰å¹³å°ä¸Šéƒ½èƒ½æ­£å¸¸å·¥ä½œ
5. **æƒé™é—®é¢˜**ï¼šå¦‚æœé‡åˆ°æƒé™é—®é¢˜ï¼Œè¯·ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ

## ğŸŒŸ è„šæœ¬ç‰¹ç‚¹

- **è·¨å¹³å°å…¼å®¹**ï¼šæ”¯æŒWindowsã€Linuxã€macOS
- **å½©è‰²è¾“å‡º**ï¼šæ¸…æ™°çš„æ­¥éª¤æç¤ºå’ŒçŠ¶æ€æ˜¾ç¤º
- **é”™è¯¯å¤„ç†**ï¼šè¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å’Œè§£å†³å»ºè®®
- **å®‰å…¨å¯é **ï¼šä¸ä¼šåˆ é™¤æ•°æ®åº“æ•°æ®
- **å¿«é€Ÿæ‰§è¡Œ**ï¼šé€šå¸¸å‡ ç§’é’Ÿå†…å®Œæˆé‡ç½®

ç°åœ¨æ‚¨æœ‰äº†å®Œæ•´çš„è·¨å¹³å°Prismaå®¢æˆ·ç«¯ç®¡ç†å·¥å…·ï¼ğŸ‰
